{"ast":null,"code":"import _objectSpread from\"C:/Users/Me/Desktop/orthnova-app/orthnova-offline/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useState}from'react';import{getDoctorById,getPatientById,listAppointments,updateAppointment}from'../../api';import{formatDateTime}from'../../utils/format';import{useAuth}from'../../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AppointmentsList=()=>{const{user}=useAuth();const[rows,setRows]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[searchText,setSearchText]=useState('');const[searchDate,setSearchDate]=useState(()=>{// Set default to today's date\nconst today=new Date();return today.toISOString().slice(0,10);});const[showActionModal,setShowActionModal]=useState(false);const[selectedAppointment,setSelectedAppointment]=useState(null);const[actionType,setActionType]=useState('');const handleAppointmentAction=async(appointmentId,action)=>{try{let status;switch(action){case'attended':status='completed';break;case'cancel':status='cancelled';break;case'reschedule':// For reschedule, we would typically open a modal or redirect to booking page\nalert('Reschedule functionality would be implemented here');return;default:return;}await updateAppointment(appointmentId,{status});// Refresh the appointment list\nconst filters={};if((user===null||user===void 0?void 0:user.role)==='doctor'&&user!==null&&user!==void 0&&user.userId){filters.doctor_id=user===null||user===void 0?void 0:user.userId;}if(searchDate){filters.appointment_date_exact=searchDate;}const list=await listAppointments(filters);const enriched=await Promise.all(list.map(async r=>{var _p$contact,_r$guest_contact;const[p,d]=await Promise.all([r.patient_id?getPatientById(r.patient_id):Promise.resolve(null),getDoctorById(r.doctor_id)]);return _objectSpread(_objectSpread({},r),{},{patientName:(p===null||p===void 0?void 0:p.name)||r.guest_name||undefined,doctorName:d===null||d===void 0?void 0:d.name,patientContact:r.patient_id?(_p$contact=p===null||p===void 0?void 0:p.contact)!==null&&_p$contact!==void 0?_p$contact:null:(_r$guest_contact=r.guest_contact)!==null&&_r$guest_contact!==void 0?_r$guest_contact:null});}));setRows(enriched);}catch(e){setError(e.message||'Failed to update appointment');}};useEffect(()=>{(async()=>{setLoading(true);setError(null);try{// For receptionist and admin, fetch all appointments\n// For doctor, fetch only their appointments\n// Filter by exact date when appointment_datetime is available\nlet filters={};if((user===null||user===void 0?void 0:user.role)==='doctor'&&user!==null&&user!==void 0&&user.userId){filters=_objectSpread(_objectSpread({},filters),{},{doctor_id:user===null||user===void 0?void 0:user.userId});}if(searchDate){filters=_objectSpread(_objectSpread({},filters),{},{appointment_date_exact:searchDate});}const list=await listAppointments(filters);const enriched=await Promise.all(list.map(async r=>{var _p$contact2,_r$guest_contact2;const[p,d]=await Promise.all([r.patient_id?getPatientById(r.patient_id):Promise.resolve(null),getDoctorById(r.doctor_id)]);return _objectSpread(_objectSpread({},r),{},{patientName:(p===null||p===void 0?void 0:p.name)||r.guest_name||undefined,doctorName:d===null||d===void 0?void 0:d.name,patientContact:r.patient_id?(_p$contact2=p===null||p===void 0?void 0:p.contact)!==null&&_p$contact2!==void 0?_p$contact2:null:(_r$guest_contact2=r.guest_contact)!==null&&_r$guest_contact2!==void 0?_r$guest_contact2:null});}));setRows(enriched);}catch(e){setError(e.message);}finally{setLoading(false);}})();},[user,searchDate]);const filtered=useMemo(()=>{const txt=searchText.trim().toLowerCase();const date=searchDate;const filteredRows=rows.filter(r=>{const matchesText=!txt||[r.patientName,r.doctorName,r.patientContact].filter(Boolean).some(v=>String(v).toLowerCase().includes(txt));// For date matching, we'll use appointment_datetime if available, otherwise appointment_date field, otherwise fall back to created_at\nlet appointmentDate='';if(r.appointment_datetime){// Extract date from appointment_datetime timestamp\nappointmentDate=new Date(r.appointment_datetime).toISOString().slice(0,10);}else if(r.appointment_date){// appointment_date is already in YYYY-MM-DD format\nappointmentDate=r.appointment_date;}else if(r.created_at){// Extract date from created_at timestamp\nappointmentDate=new Date(r.created_at).toISOString().slice(0,10);}const matchesDate=!date||appointmentDate===date;return matchesText&&matchesDate;});// Sort by appointment datetime\nreturn filteredRows.sort((a,b)=>{// Use appointment_datetime if available, otherwise appointment_date + created_at time, or just created_at if neither is available\nlet aDateTime,bDateTime;if(a.appointment_datetime){aDateTime=new Date(a.appointment_datetime);}else if(a.appointment_date&&a.created_at){// Combine appointment date with time from created_at\nconst aTime=new Date(a.created_at).toTimeString().split(' ')[0];// Get HH:MM:SS\naDateTime=new Date(\"\".concat(a.appointment_date,\"T\").concat(aTime));}else{aDateTime=new Date(a.created_at);}if(b.appointment_datetime){bDateTime=new Date(b.appointment_datetime);}else if(b.appointment_date&&b.created_at){// Combine appointment date with time from created_at\nconst bTime=new Date(b.created_at).toTimeString().split(' ')[0];// Get HH:MM:SS\nbDateTime=new Date(\"\".concat(b.appointment_date,\"T\").concat(bTime));}else{bDateTime=new Date(b.created_at);}return aDateTime.getTime()-bDateTime.getTime();});},[rows,searchText,searchDate]);return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Search (Patient/Doctor/Contact)\"}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-1 w-full\",value:searchText,onChange:e=>setSearchText(e.target.value),placeholder:\"Type to filter\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"mt-1 w-full\",value:searchDate,onChange:e=>setSearchDate(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-end gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:()=>{setSearchText('');setSearchDate(new Date().toISOString().slice(0,10));},disabled:loading,children:\"Today\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:()=>{setSearchText('');setSearchDate('');},disabled:loading,children:\"Clear\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold\",children:\"Appointment History\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:searchDate&&\"Showing appointments for \".concat(new Date(searchDate).toLocaleDateString())}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:()=>window.location.reload(),disabled:loading,children:\"Refresh\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mb-2\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-left text-gray-500\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-2 pr-4\",children:\"Appointment Date/Time\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 pr-4\",children:\"Patient\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 pr-4\",children:\"Contact\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 pr-4\",children:\"Doctor\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 pr-4\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 pr-4\",children:\"Notes\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-2 pr-4\",children:\"Actions\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[filtered.map(r=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t border-gray-100\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-2 pr-4\",children:formatDateTime(r.appointment_datetime||r.created_at)}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 pr-4\",children:r.patientName||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 pr-4\",children:r.patientContact||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 pr-4\",children:r.doctorName||r.doctor_id}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 pr-4 capitalize\",children:r.status}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 pr-4\",children:r.notes||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 pr-4\",children:r.status==='booked'&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAppointmentAction(r.id,'attended'),className:\"text-green-600 hover:text-green-900 text-sm\",children:\"Attended\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAppointmentAction(r.id,'reschedule'),className:\"text-blue-600 hover:text-blue-900 text-sm\",children:\"Reschedule\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAppointmentAction(r.id,'cancel'),className:\"text-red-600 hover:text-red-900 text-sm\",children:\"Cancel\"})]})})]},r.id)),filtered.length===0&&/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{className:\"py-4 text-gray-500\",colSpan:7,children:loading?'Loading...':'No appointments found.'})})]})]})})]})]});};export default AppointmentsList;","map":{"version":3,"names":["React","useEffect","useMemo","useState","getDoctorById","getPatientById","listAppointments","updateAppointment","formatDateTime","useAuth","jsx","_jsx","jsxs","_jsxs","AppointmentsList","user","rows","setRows","loading","setLoading","error","setError","searchText","setSearchText","searchDate","setSearchDate","today","Date","toISOString","slice","showActionModal","setShowActionModal","selectedAppointment","setSelectedAppointment","actionType","setActionType","handleAppointmentAction","appointmentId","action","status","alert","filters","role","userId","doctor_id","appointment_date_exact","list","enriched","Promise","all","map","r","_p$contact","_r$guest_contact","p","d","patient_id","resolve","_objectSpread","patientName","name","guest_name","undefined","doctorName","patientContact","contact","guest_contact","e","message","_p$contact2","_r$guest_contact2","filtered","txt","trim","toLowerCase","date","filteredRows","filter","matchesText","Boolean","some","v","String","includes","appointmentDate","appointment_datetime","appointment_date","created_at","matchesDate","sort","a","b","aDateTime","bDateTime","aTime","toTimeString","split","concat","bTime","getTime","className","children","value","onChange","target","placeholder","type","onClick","disabled","toLocaleDateString","window","location","reload","notes","id","length","colSpan"],"sources":["C:/Users/Me/Desktop/orthnova-app/orthnova-offline/src/components/appointments/AppointmentsList.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { getDoctorById, getPatientById, listAppointments, updateAppointment } from '../../api';\r\nimport { AppointmentRow } from '../../types';\r\nimport { formatDateTime } from '../../utils/format';\r\nimport { useAuth } from '../../context/AuthContext';\r\n\r\ninterface Row extends AppointmentRow { patientName?: string; doctorName?: string; patientContact?: string | null }\r\n\r\nconst AppointmentsList: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const [rows, setRows] = useState<Row[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const [searchText, setSearchText] = useState('');\r\n  const [searchDate, setSearchDate] = useState(() => {\r\n    // Set default to today's date\r\n    const today = new Date();\r\n    return today.toISOString().slice(0, 10);\r\n  });\r\n  \r\n  const [showActionModal, setShowActionModal] = useState(false);\r\n  const [selectedAppointment, setSelectedAppointment] = useState<AppointmentRow | null>(null);\r\n  const [actionType, setActionType] = useState('');\r\n  \r\n  const handleAppointmentAction = async (appointmentId: string, action: string) => {\r\n    try {\r\n      let status: 'completed' | 'cancelled' | 'booked' | undefined;\r\n      switch (action) {\r\n        case 'attended':\r\n          status = 'completed';\r\n          break;\r\n        case 'cancel':\r\n          status = 'cancelled';\r\n          break;\r\n        case 'reschedule':\r\n          // For reschedule, we would typically open a modal or redirect to booking page\r\n          alert('Reschedule functionality would be implemented here');\r\n          return;\r\n        default:\r\n          return;\r\n      }\r\n      \r\n      await updateAppointment(appointmentId, { status });\r\n      \r\n      // Refresh the appointment list\r\n      const filters: { doctor_id?: string; appointment_date_exact?: string } = {};\r\n      if (user?.role === 'doctor' && user?.userId) {\r\n        filters.doctor_id = user?.userId;\r\n      }\r\n      if (searchDate) {\r\n        filters.appointment_date_exact = searchDate;\r\n      }\r\n      const list = await listAppointments(filters);\r\n      const enriched: Row[] = await Promise.all(list.map(async r => {\r\n        const [p, d] = await Promise.all([\r\n          r.patient_id ? getPatientById(r.patient_id) : Promise.resolve(null),\r\n          getDoctorById(r.doctor_id)\r\n        ]);\r\n        return { ...r, patientName: p?.name || r.guest_name || undefined, doctorName: d?.name, patientContact: r.patient_id ? p?.contact ?? null : (r.guest_contact ?? null) };\r\n      }));\r\n      setRows(enriched);\r\n    } catch (e: any) {\r\n      setError(e.message || 'Failed to update appointment');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      setLoading(true); setError(null);\r\n      try {\r\n        // For receptionist and admin, fetch all appointments\r\n        // For doctor, fetch only their appointments\r\n        // Filter by exact date when appointment_datetime is available\r\n        let filters: { doctor_id?: string; appointment_date_exact?: string } = {};\r\n        if (user?.role === 'doctor' && user?.userId) {\r\n          filters = { ...filters, doctor_id: user?.userId };\r\n        }\r\n        if (searchDate) {\r\n          filters = { ...filters, appointment_date_exact: searchDate };\r\n        }\r\n        const list = await listAppointments(filters);\r\n        const enriched: Row[] = await Promise.all(list.map(async r => {\r\n          const [p, d] = await Promise.all([\r\n            r.patient_id ? getPatientById(r.patient_id) : Promise.resolve(null),\r\n            getDoctorById(r.doctor_id)\r\n          ]);\r\n          return { ...r, patientName: p?.name || r.guest_name || undefined, doctorName: d?.name, patientContact: r.patient_id ? p?.contact ?? null : (r.guest_contact ?? null) };\r\n        }));\r\n        setRows(enriched);\r\n      } catch (e: any) { setError(e.message); }\r\n      finally { setLoading(false); }\r\n    })();\r\n  }, [user, searchDate]);\r\n\r\n  const filtered = useMemo(() => {\r\n    const txt = searchText.trim().toLowerCase();\r\n    const date = searchDate;\r\n    const filteredRows = rows.filter(r => {\r\n      const matchesText = !txt || [r.patientName, r.doctorName, r.patientContact]\r\n        .filter(Boolean)\r\n        .some(v => String(v).toLowerCase().includes(txt));\r\n      \r\n      // For date matching, we'll use appointment_datetime if available, otherwise appointment_date field, otherwise fall back to created_at\r\n      let appointmentDate = '';\r\n      if (r.appointment_datetime) {\r\n        // Extract date from appointment_datetime timestamp\r\n        appointmentDate = new Date(r.appointment_datetime).toISOString().slice(0,10);\r\n      } else if (r.appointment_date) {\r\n        // appointment_date is already in YYYY-MM-DD format\r\n        appointmentDate = r.appointment_date;\r\n      } else if (r.created_at) {\r\n        // Extract date from created_at timestamp\r\n        appointmentDate = new Date(r.created_at).toISOString().slice(0,10);\r\n      }\r\n      \r\n      const matchesDate = !date || appointmentDate === date;\r\n      return matchesText && matchesDate;\r\n    });\r\n    \r\n    // Sort by appointment datetime\r\n    return filteredRows.sort((a, b) => {\r\n      // Use appointment_datetime if available, otherwise appointment_date + created_at time, or just created_at if neither is available\r\n      let aDateTime, bDateTime;\r\n      \r\n      if (a.appointment_datetime) {\r\n        aDateTime = new Date(a.appointment_datetime);\r\n      } else if (a.appointment_date && a.created_at) {\r\n        // Combine appointment date with time from created_at\r\n        const aTime = new Date(a.created_at).toTimeString().split(' ')[0]; // Get HH:MM:SS\r\n        aDateTime = new Date(`${a.appointment_date}T${aTime}`);\r\n      } else {\r\n        aDateTime = new Date(a.created_at);\r\n      }\r\n      \r\n      if (b.appointment_datetime) {\r\n        bDateTime = new Date(b.appointment_datetime);\r\n      } else if (b.appointment_date && b.created_at) {\r\n        // Combine appointment date with time from created_at\r\n        const bTime = new Date(b.created_at).toTimeString().split(' ')[0]; // Get HH:MM:SS\r\n        bDateTime = new Date(`${b.appointment_date}T${bTime}`);\r\n      } else {\r\n        bDateTime = new Date(b.created_at);\r\n      }\r\n      \r\n      return aDateTime.getTime() - bDateTime.getTime();\r\n    });\r\n  }, [rows, searchText, searchDate]);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"card p-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">Search (Patient/Doctor/Contact)</label>\r\n            <input className=\"mt-1 w-full\" value={searchText} onChange={e => setSearchText(e.target.value)} placeholder=\"Type to filter\" />\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">Date</label>\r\n            <input type=\"date\" className=\"mt-1 w-full\" value={searchDate} onChange={e => setSearchDate(e.target.value)} />\r\n          </div>\r\n          <div className=\"flex items-end gap-2\">\r\n            <button className=\"btn btn-secondary\" onClick={() => { setSearchText(''); setSearchDate(new Date().toISOString().slice(0, 10)); }} disabled={loading}>Today</button>\r\n            <button className=\"btn btn-secondary\" onClick={() => { setSearchText(''); setSearchDate(''); }} disabled={loading}>Clear</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"card p-6\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h2 className=\"text-xl font-semibold\">Appointment History</h2>\r\n          <div className=\"text-sm text-gray-600\">\r\n            {searchDate && `Showing appointments for ${new Date(searchDate).toLocaleDateString()}`}\r\n          </div>\r\n          <button className=\"btn btn-secondary\" onClick={() => window.location.reload()} disabled={loading}>Refresh</button>\r\n        </div>\r\n        {error && <p className=\"text-red-600 text-sm mb-2\">{error}</p>}\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full text-sm\">\r\n            <thead>\r\n              <tr className=\"text-left text-gray-500\">\r\n                <th className=\"py-2 pr-4\">Appointment Date/Time</th>\r\n                <th className=\"py-2 pr-4\">Patient</th>\r\n                <th className=\"py-2 pr-4\">Contact</th>\r\n                <th className=\"py-2 pr-4\">Doctor</th>\r\n                <th className=\"py-2 pr-4\">Status</th>\r\n                <th className=\"py-2 pr-4\">Notes</th>\r\n                <th className=\"py-2 pr-4\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filtered.map(r => (\r\n                <tr key={r.id} className=\"border-t border-gray-100\">\r\n                  <td className=\"py-2 pr-4\">{formatDateTime(r.appointment_datetime || r.created_at)}</td>\r\n                  <td className=\"py-2 pr-4\">{r.patientName || '-'}</td>\r\n                  <td className=\"py-2 pr-4\">{r.patientContact || '-'}</td>\r\n                  <td className=\"py-2 pr-4\">{r.doctorName || r.doctor_id}</td>\r\n                  <td className=\"py-2 pr-4 capitalize\">{r.status}</td>\r\n                  <td className=\"py-2 pr-4\">{r.notes || '-'}</td>\r\n                  <td className=\"py-2 pr-4\">\r\n                    {r.status === 'booked' && (\r\n                      <div className=\"flex space-x-2\">\r\n                        <button \r\n                          onClick={() => handleAppointmentAction(r.id, 'attended')}\r\n                          className=\"text-green-600 hover:text-green-900 text-sm\"\r\n                        >\r\n                          Attended\r\n                        </button>\r\n                        <button \r\n                          onClick={() => handleAppointmentAction(r.id, 'reschedule')}\r\n                          className=\"text-blue-600 hover:text-blue-900 text-sm\"\r\n                        >\r\n                          Reschedule\r\n                        </button>\r\n                        <button \r\n                          onClick={() => handleAppointmentAction(r.id, 'cancel')}\r\n                          className=\"text-red-600 hover:text-red-900 text-sm\"\r\n                        >\r\n                          Cancel\r\n                        </button>\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n              {filtered.length === 0 && (\r\n                <tr><td className=\"py-4 text-gray-500\" colSpan={7}>{loading ? 'Loading...' : 'No appointments found.'}</td></tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AppointmentsList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}