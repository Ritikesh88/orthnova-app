{"ast":null,"code":"import _objectSpread from\"C:/Users/Me/Desktop/orthnova-app/orthnova-offline/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useState}from'react';import{createBill,listInventoryItems,searchPatientsByContact}from'../../api';import{generateBillNumber}from'../../utils/format';import{useAuth}from'../../context/AuthContext';import Modal from'../common/Modal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MODES=['Cash','UPI','Card'];const PharmacyBilling=()=>{const{user}=useAuth();const[inventory,setInventory]=useState([]);const[query,setQuery]=useState('');const[selected,setSelected]=useState([]);// Patient/guest management\nconst[patientSearch,setPatientSearch]=useState('');const[patientId,setPatientId]=useState('');const[selectedPatient,setSelectedPatient]=useState(null);const[patientMatches,setPatientMatches]=useState([]);const[patientModalOpen,setPatientModalOpen]=useState(false);const[isGuest,setIsGuest]=useState(false);const[guestName,setGuestName]=useState('');const[guestContact,setGuestContact]=useState('');// Billing details\nconst[discount,setDiscount]=useState(0);const[mode,setMode]=useState('Cash');const[txnRef,setTxnRef]=useState('');const[status,setStatus]=useState('paid');// UI state\nconst[submitting,setSubmitting]=useState(false);const[message,setMessage]=useState(null);useEffect(()=>{loadInventory();},[]);const loadInventory=async()=>{try{const data=await listInventoryItems();setInventory(data);}catch(e){setMessage(e.message);}};const filtered=useMemo(()=>{const q=query.trim().toLowerCase();if(!q)return inventory;return inventory.filter(i=>i.name.toLowerCase().includes(q)||i.sku.toLowerCase().includes(q)||i.category.toLowerCase().includes(q)||i.manufacturer.toLowerCase().includes(q));},[inventory,query]);const addItem=item=>{if(item.current_stock<=0){setMessage('Item is out of stock');return;}setSelected(prev=>{const existing=prev.find(p=>p.item.id===item.id);if(existing){const newQty=existing.quantity+1;if(newQty>item.current_stock){setMessage(\"Only \".concat(item.current_stock,\" items available in stock\"));return prev;}return prev.map(p=>p.item.id===item.id?_objectSpread(_objectSpread({},p),{},{quantity:newQty}):p);}return[...prev,{item,quantity:1}];});};const updateQty=(id,qty)=>{const item=selected.find(s=>s.item.id===id);if(!item)return;if(qty<=0){setSelected(prev=>prev.filter(p=>p.item.id!==id));}else if(qty>item.item.current_stock){setMessage(\"Only \".concat(item.item.current_stock,\" items available in stock\"));}else{setSelected(prev=>prev.map(p=>p.item.id===id?_objectSpread(_objectSpread({},p),{},{quantity:qty}):p));}};const onSearchPatient=async()=>{setMessage(null);if(isGuest)return;try{const rows=await searchPatientsByContact(patientSearch);if(rows.length===1){setPatientId(rows[0].id);setSelectedPatient(rows[0]);setPatientMatches([]);}else if(rows.length>1){setPatientMatches(rows);setPatientModalOpen(true);}else{setSelectedPatient(null);setPatientId('');setMessage('No patients found for that contact');}}catch(e){setMessage(e.message);}};const subtotal=useMemo(()=>selected.reduce((s,p)=>s+Number(p.item.sale_price)*p.quantity,0),[selected]);const gstTotal=useMemo(()=>selected.reduce((s,p)=>s+Number(p.item.sale_price)*p.quantity*Number(p.item.gst_rate||0)/100,0),[selected]);const net=useMemo(()=>Math.max(0,subtotal+gstTotal-Number(discount||0)),[subtotal,gstTotal,discount]);const onSubmit=async e=>{e.preventDefault();setMessage(null);if(!patientId&&!isGuest||selected.length===0){setMessage('Select patient/guest and add at least one medicine');return;}if(isGuest&&(!guestName.trim()||!guestContact.trim())){setMessage('Enter guest name and contact');return;}if((mode==='UPI'||mode==='Card')&&!txnRef.trim()){setMessage('Transaction reference required for UPI/Card');return;}setSubmitting(true);try{const bill_number=generateBillNumber();const billInsert={patient_id:isGuest?null:patientId,doctor_id:null,// No doctor for medicine store bills\ntotal_amount:subtotal+gstTotal,discount:Number(discount||0),net_amount:net,status,bill_number,mode_of_payment:mode,transaction_reference:mode==='UPI'||mode==='Card'?txnRef:null,guest_name:isGuest?guestName.trim():null,guest_contact:isGuest?guestContact.trim():null,bill_type:'pharmacy',is_medicine_store_bill:true,created_at:new Date().toISOString()};const itemsInsert=selected.map(s=>({bill_id:'',inventory_item_id:s.item.id,item_name:s.item.name,quantity:s.quantity,price:Number(s.item.sale_price),total:Number(s.item.sale_price)*s.quantity}));const inserted=await createBill(billInsert,itemsInsert);localStorage.setItem('orthonova_last_bill_id',inserted.id);setMessage('Medicine bill generated successfully');// Open print window\nconst url=\"\".concat(window.location.origin,\"/print/bill/\").concat(inserted.id);const win=window.open(url,'_blank');if(win)win.focus();// Reset form\nsetSelected([]);setDiscount(0);setMode('Cash');setTxnRef('');setStatus('paid');setPatientId('');setSelectedPatient(null);setIsGuest(false);setGuestName('');setGuestContact('');setPatientSearch('');// Refresh inventory to update stock\nawait loadInventory();}catch(e){setMessage(e.message);}finally{setSubmitting(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-4\",children:\"Medicine Store Billing\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Patient Contact\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-1\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Enter contact number\",className:\"flex-1 rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\",value:patientSearch,onChange:e=>setPatientSearch(e.target.value),disabled:isGuest}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:onSearchPatient,disabled:isGuest,children:\"Search\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600\",children:\"Patient Name\"}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-1 w-full rounded-xl border border-gray-300 bg-gray-50\",value:(selectedPatient===null||selectedPatient===void 0?void 0:selectedPatient.name)||'',readOnly:true,placeholder:\"No patient selected\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"guest-toggle\",type:\"checkbox\",checked:isGuest,onChange:e=>{setIsGuest(e.target.checked);if(e.target.checked){setSelectedPatient(null);setPatientId('');}}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"guest-toggle\",className:\"text-sm\",children:\"Bill for non-registered customer\"})]}),isGuest&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Customer Name\"}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\",value:guestName,onChange:e=>setGuestName(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Customer Contact\"}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\",value:guestContact,onChange:e=>setGuestContact(e.target.value)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Discount (\\u20B9)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",className:\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\",value:discount,onChange:e=>setDiscount(Number(e.target.value))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Payment Mode\"}),/*#__PURE__*/_jsx(\"select\",{className:\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\",value:mode,onChange:e=>setMode(e.target.value),children:MODES.map(m=>/*#__PURE__*/_jsx(\"option\",{value:m,children:m},m))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\",value:status,onChange:e=>setStatus(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"paid\",children:\"Paid\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"Pending\"}),/*#__PURE__*/_jsx(\"option\",{value:\"partial\",children:\"Partial\"})]})]})]})]}),(mode==='UPI'||mode==='Card')&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Transaction Reference\"}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\",value:txnRef,onChange:e=>setTxnRef(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium\",children:\"Medicines\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Search by name, SKU, category, manufacturer\",className:\"rounded-xl border-gray-300\",value:query,onChange:e=>setQuery(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-h-64 overflow-y-auto divide-y divide-gray-100\",children:[filtered.map(i=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between py-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:i.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[i.category,\" \\u2022 \",i.manufacturer,\" \\u2022 \",i.unit,\" \\u2022 \\u20B9\",Number(i.sale_price).toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"Stock: \",i.current_stock,\" \\u2022 GST: \",i.gst_rate||0,\"%\"]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary ml-2\",onClick:()=>addItem(i),disabled:i.current_stock<=0,children:i.current_stock<=0?'Out of Stock':'Add'})]},i.id)),filtered.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 p-2\",children:\"No medicines found.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium mb-2\",children:\"Selected Items\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[selected.map(s=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:s.item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"\\u20B9\",Number(s.item.sale_price).toFixed(2),\" \\xD7 \",s.quantity,\" = \\u20B9\",(Number(s.item.sale_price)*s.quantity).toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"GST: \\u20B9\",(Number(s.item.sale_price)*s.quantity*Number(s.item.gst_rate||0)/100).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:0,max:s.item.current_stock,className:\"w-20 rounded-xl border border-gray-300\",value:s.quantity,onChange:e=>updateQty(s.item.id,Number(e.target.value))}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-24 text-right\",children:[\"\\u20B9\",(Number(s.item.sale_price)*s.quantity+Number(s.item.sale_price)*s.quantity*Number(s.item.gst_rate||0)/100).toFixed(2)]})]})]},s.item.id)),selected.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"No items added.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-100 mt-3 pt-3 text-sm space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Subtotal\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",subtotal.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"GST\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",gstTotal.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between font-medium\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Gross Total\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",(subtotal+gstTotal).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Discount\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"-\\u20B9\",Number(discount||0).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-lg font-semibold\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Net Amount\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",net.toFixed(2)]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",disabled:submitting,children:\"Generate Medicine Bill\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:()=>{const id=localStorage.getItem('orthonova_last_bill_id');if(!id){setMessage('No recent bill to reprint');return;}const url=\"\".concat(window.location.origin,\"/print/bill/\").concat(id);const win=window.open(url,'_blank');if(win)win.focus();},children:\"Reprint Last\"})]}),message&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-2 \".concat(message.includes('successfully')?'text-green-600':'text-red-600'),children:message})]})]}),/*#__PURE__*/_jsx(Modal,{open:patientModalOpen,title:\"Select Patient\",onClose:()=>setPatientModalOpen(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"divide-y divide-gray-100\",children:[patientMatches.map(p=>/*#__PURE__*/_jsx(\"div\",{className:\"py-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium\",children:[p.name,\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500\",children:[\"(\",p.age,\" / \",p.gender,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[p.patient_id,\" \\u2022 \",p.contact]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:()=>{setPatientId(p.id);setSelectedPatient(p);setPatientModalOpen(false);setPatientMatches([]);},children:\"Select\"})]})},p.id)),patientMatches.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"py-4 text-sm text-gray-500\",children:\"No matches.\"})]})})]});};export default PharmacyBilling;","map":{"version":3,"names":["React","useEffect","useMemo","useState","createBill","listInventoryItems","searchPatientsByContact","generateBillNumber","useAuth","Modal","jsx","_jsx","jsxs","_jsxs","MODES","PharmacyBilling","user","inventory","setInventory","query","setQuery","selected","setSelected","patientSearch","setPatientSearch","patientId","setPatientId","selectedPatient","setSelectedPatient","patientMatches","setPatientMatches","patientModalOpen","setPatientModalOpen","isGuest","setIsGuest","guestName","setGuestName","guestContact","setGuestContact","discount","setDiscount","mode","setMode","txnRef","setTxnRef","status","setStatus","submitting","setSubmitting","message","setMessage","loadInventory","data","e","filtered","q","trim","toLowerCase","filter","i","name","includes","sku","category","manufacturer","addItem","item","current_stock","prev","existing","find","p","id","newQty","quantity","concat","map","_objectSpread","updateQty","qty","s","onSearchPatient","rows","length","subtotal","reduce","Number","sale_price","gstTotal","gst_rate","net","Math","max","onSubmit","preventDefault","bill_number","billInsert","patient_id","doctor_id","total_amount","net_amount","mode_of_payment","transaction_reference","guest_name","guest_contact","bill_type","is_medicine_store_bill","created_at","Date","toISOString","itemsInsert","bill_id","inventory_item_id","item_name","price","total","inserted","localStorage","setItem","url","window","location","origin","win","open","focus","className","children","placeholder","value","onChange","target","disabled","type","onClick","readOnly","checked","htmlFor","step","m","required","unit","toFixed","min","getItem","title","onClose","age","gender","contact"],"sources":["C:/Users/Me/Desktop/orthnova-app/orthnova-offline/src/components/billing/PharmacyBilling.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { createBill, listInventoryItems, searchPatientsByContact } from '../../api';\r\nimport { BillItemRow, InventoryItemRow, PatientRow } from '../../types';\r\nimport { formatCurrency, generateBillNumber } from '../../utils/format';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport Modal from '../common/Modal';\r\n\r\nconst MODES = ['Cash', 'UPI', 'Card'] as const;\r\ntype Mode = typeof MODES[number];\r\n\r\ninterface SelectedItem { \r\n  item: InventoryItemRow; \r\n  quantity: number; \r\n}\r\n\r\nconst PharmacyBilling: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const [inventory, setInventory] = useState<InventoryItemRow[]>([]);\r\n  const [query, setQuery] = useState('');\r\n  const [selected, setSelected] = useState<SelectedItem[]>([]);\r\n  \r\n  // Patient/guest management\r\n  const [patientSearch, setPatientSearch] = useState('');\r\n  const [patientId, setPatientId] = useState('');\r\n  const [selectedPatient, setSelectedPatient] = useState<PatientRow | null>(null);\r\n  const [patientMatches, setPatientMatches] = useState<PatientRow[]>([]);\r\n  const [patientModalOpen, setPatientModalOpen] = useState(false);\r\n  const [isGuest, setIsGuest] = useState(false);\r\n  const [guestName, setGuestName] = useState('');\r\n  const [guestContact, setGuestContact] = useState('');\r\n  \r\n  // Billing details\r\n  const [discount, setDiscount] = useState(0);\r\n  const [mode, setMode] = useState<Mode>('Cash');\r\n  const [txnRef, setTxnRef] = useState('');\r\n  const [status, setStatus] = useState<'paid' | 'pending' | 'partial'>('paid');\r\n  \r\n  // UI state\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [message, setMessage] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    loadInventory();\r\n  }, []);\r\n\r\n  const loadInventory = async () => {\r\n    try {\r\n      const data = await listInventoryItems();\r\n      setInventory(data);\r\n    } catch (e: any) {\r\n      setMessage(e.message);\r\n    }\r\n  };\r\n\r\n  const filtered = useMemo(() => {\r\n    const q = query.trim().toLowerCase();\r\n    if (!q) return inventory;\r\n    return inventory.filter(i => \r\n      i.name.toLowerCase().includes(q) || \r\n      i.sku.toLowerCase().includes(q) ||\r\n      i.category.toLowerCase().includes(q) ||\r\n      i.manufacturer.toLowerCase().includes(q)\r\n    );\r\n  }, [inventory, query]);\r\n\r\n  const addItem = (item: InventoryItemRow) => {\r\n    if (item.current_stock <= 0) {\r\n      setMessage('Item is out of stock');\r\n      return;\r\n    }\r\n    \r\n    setSelected(prev => {\r\n      const existing = prev.find(p => p.item.id === item.id);\r\n      if (existing) {\r\n        const newQty = existing.quantity + 1;\r\n        if (newQty > item.current_stock) {\r\n          setMessage(`Only ${item.current_stock} items available in stock`);\r\n          return prev;\r\n        }\r\n        return prev.map(p => p.item.id === item.id ? { ...p, quantity: newQty } : p);\r\n      }\r\n      return [...prev, { item, quantity: 1 }];\r\n    });\r\n  };\r\n\r\n  const updateQty = (id: string, qty: number) => {\r\n    const item = selected.find(s => s.item.id === id);\r\n    if (!item) return;\r\n    \r\n    if (qty <= 0) {\r\n      setSelected(prev => prev.filter(p => p.item.id !== id));\r\n    } else if (qty > item.item.current_stock) {\r\n      setMessage(`Only ${item.item.current_stock} items available in stock`);\r\n    } else {\r\n      setSelected(prev => prev.map(p => p.item.id === id ? { ...p, quantity: qty } : p));\r\n    }\r\n  };\r\n\r\n  const onSearchPatient = async () => {\r\n    setMessage(null);\r\n    if (isGuest) return;\r\n    \r\n    try {\r\n      const rows = await searchPatientsByContact(patientSearch);\r\n      if (rows.length === 1) {\r\n        setPatientId(rows[0].id);\r\n        setSelectedPatient(rows[0]);\r\n        setPatientMatches([]);\r\n      } else if (rows.length > 1) {\r\n        setPatientMatches(rows);\r\n        setPatientModalOpen(true);\r\n      } else {\r\n        setSelectedPatient(null);\r\n        setPatientId('');\r\n        setMessage('No patients found for that contact');\r\n      }\r\n    } catch (e: any) {\r\n      setMessage(e.message);\r\n    }\r\n  };\r\n\r\n  const subtotal = useMemo(() => \r\n    selected.reduce((s, p) => s + Number(p.item.sale_price) * p.quantity, 0), \r\n    [selected]\r\n  );\r\n  \r\n  const gstTotal = useMemo(() => \r\n    selected.reduce((s, p) => s + (Number(p.item.sale_price) * p.quantity * Number(p.item.gst_rate || 0) / 100), 0), \r\n    [selected]\r\n  );\r\n  \r\n  const net = useMemo(() => \r\n    Math.max(0, subtotal + gstTotal - Number(discount || 0)), \r\n    [subtotal, gstTotal, discount]\r\n  );\r\n\r\n  const onSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault(); \r\n    setMessage(null);\r\n    \r\n    if ((!patientId && !isGuest) || selected.length === 0) { \r\n      setMessage('Select patient/guest and add at least one medicine'); \r\n      return; \r\n    }\r\n    \r\n    if (isGuest && (!guestName.trim() || !guestContact.trim())) { \r\n      setMessage('Enter guest name and contact'); \r\n      return; \r\n    }\r\n    \r\n    if ((mode === 'UPI' || mode === 'Card') && !txnRef.trim()) { \r\n      setMessage('Transaction reference required for UPI/Card'); \r\n      return; \r\n    }\r\n\r\n    setSubmitting(true);\r\n    try {\r\n      const bill_number = generateBillNumber();\r\n      const billInsert = {\r\n        patient_id: isGuest ? null : patientId,\r\n        doctor_id: null, // No doctor for medicine store bills\r\n        total_amount: subtotal + gstTotal,\r\n        discount: Number(discount || 0),\r\n        net_amount: net,\r\n        status,\r\n        bill_number,\r\n        mode_of_payment: mode,\r\n        transaction_reference: (mode === 'UPI' || mode === 'Card') ? txnRef : null,\r\n        guest_name: isGuest ? guestName.trim() : null,\r\n        guest_contact: isGuest ? guestContact.trim() : null,\r\n        bill_type: 'pharmacy',\r\n        is_medicine_store_bill: true,\r\n        created_at: new Date().toISOString(),\r\n      } as const;\r\n\r\n      const itemsInsert: Array<Omit<BillItemRow, 'id'>> = selected.map(s => ({\r\n        bill_id: '',\r\n        inventory_item_id: s.item.id,\r\n        item_name: s.item.name,\r\n        quantity: s.quantity,\r\n        price: Number(s.item.sale_price),\r\n        total: Number(s.item.sale_price) * s.quantity,\r\n      }));\r\n\r\n      const inserted = await createBill(billInsert as any, itemsInsert);\r\n      localStorage.setItem('orthonova_last_bill_id', inserted.id);\r\n      setMessage('Medicine bill generated successfully');\r\n      \r\n      // Open print window\r\n      const url = `${window.location.origin}/print/bill/${inserted.id}`;\r\n      const win = window.open(url, '_blank'); \r\n      if (win) win.focus();\r\n      \r\n      // Reset form\r\n      setSelected([]); \r\n      setDiscount(0); \r\n      setMode('Cash'); \r\n      setTxnRef(''); \r\n      setStatus('paid');\r\n      setPatientId('');\r\n      setSelectedPatient(null);\r\n      setIsGuest(false);\r\n      setGuestName('');\r\n      setGuestContact('');\r\n      setPatientSearch('');\r\n      \r\n      // Refresh inventory to update stock\r\n      await loadInventory();\r\n    } catch (e: any) { \r\n      setMessage(e.message); \r\n    } finally { \r\n      setSubmitting(false); \r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"card p-6\">\r\n        <h2 className=\"text-xl font-semibold mb-4\">Medicine Store Billing</h2>\r\n        <form onSubmit={onSubmit} className=\"space-y-4\">\r\n          {/* Patient/Guest Selection */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium\">Patient Contact</label>\r\n              <div className=\"flex gap-2 mt-1\">\r\n                <input\r\n                  placeholder=\"Enter contact number\"\r\n                  className=\"flex-1 rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\"\r\n                  value={patientSearch}\r\n                  onChange={e => setPatientSearch(e.target.value)}\r\n                  disabled={isGuest}\r\n                />\r\n                <button type=\"button\" className=\"btn btn-secondary\" onClick={onSearchPatient} disabled={isGuest}>\r\n                  Search\r\n                </button>\r\n              </div>\r\n              <div className=\"mt-2\">\r\n                <label className=\"block text-xs text-gray-600\">Patient Name</label>\r\n                <input \r\n                  className=\"mt-1 w-full rounded-xl border border-gray-300 bg-gray-50\" \r\n                  value={selectedPatient?.name || ''} \r\n                  readOnly \r\n                  placeholder=\"No patient selected\" \r\n                />\r\n              </div>\r\n              <div className=\"mt-3 flex items-center gap-2\">\r\n                <input \r\n                  id=\"guest-toggle\" \r\n                  type=\"checkbox\" \r\n                  checked={isGuest} \r\n                  onChange={e => { \r\n                    setIsGuest(e.target.checked); \r\n                    if (e.target.checked) { \r\n                      setSelectedPatient(null); \r\n                      setPatientId(''); \r\n                    } \r\n                  }} \r\n                />\r\n                <label htmlFor=\"guest-toggle\" className=\"text-sm\">Bill for non-registered customer</label>\r\n              </div>\r\n              {isGuest && (\r\n                <div className=\"mt-2 space-y-2\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium\">Customer Name</label>\r\n                    <input \r\n                      className=\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\" \r\n                      value={guestName} \r\n                      onChange={e => setGuestName(e.target.value)} \r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium\">Customer Contact</label>\r\n                    <input \r\n                      className=\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\" \r\n                      value={guestContact} \r\n                      onChange={e => setGuestContact(e.target.value)} \r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n            \r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium\">Discount (₹)</label>\r\n                <input \r\n                  type=\"number\" \r\n                  step=\"0.01\" \r\n                  className=\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\" \r\n                  value={discount} \r\n                  onChange={e => setDiscount(Number(e.target.value))} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium\">Payment Mode</label>\r\n                <select \r\n                  className=\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\" \r\n                  value={mode} \r\n                  onChange={e => setMode(e.target.value as Mode)}\r\n                >\r\n                  {MODES.map(m => <option key={m} value={m}>{m}</option>)}\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium\">Status</label>\r\n                <select \r\n                  className=\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\" \r\n                  value={status} \r\n                  onChange={e => setStatus(e.target.value as any)}\r\n                >\r\n                  <option value=\"paid\">Paid</option>\r\n                  <option value=\"pending\">Pending</option>\r\n                  <option value=\"partial\">Partial</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {(mode === 'UPI' || mode === 'Card') && (\r\n            <div>\r\n              <label className=\"block text-sm font-medium\">Transaction Reference</label>\r\n              <input \r\n                className=\"mt-1 w-full rounded-xl border border-gray-300 bg-white focus:border-brand-500 focus:ring-brand-500\" \r\n                value={txnRef} \r\n                onChange={e => setTxnRef(e.target.value)} \r\n                required \r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {/* Medicine Selection and Billing */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <div className=\"card p-4\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <h3 className=\"font-medium\">Medicines</h3>\r\n                <input \r\n                  placeholder=\"Search by name, SKU, category, manufacturer\" \r\n                  className=\"rounded-xl border-gray-300\" \r\n                  value={query} \r\n                  onChange={e => setQuery(e.target.value)} \r\n                />\r\n              </div>\r\n              <div className=\"max-h-64 overflow-y-auto divide-y divide-gray-100\">\r\n                {filtered.map(i => (\r\n                  <div key={i.id} className=\"flex items-center justify-between py-2\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"font-medium\">{i.name}</div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        {i.category} • {i.manufacturer} • {i.unit} • ₹{Number(i.sale_price).toFixed(2)}\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        Stock: {i.current_stock} • GST: {i.gst_rate || 0}%\r\n                      </div>\r\n                    </div>\r\n                    <button \r\n                      type=\"button\" \r\n                      className=\"btn btn-secondary ml-2\" \r\n                      onClick={() => addItem(i)} \r\n                      disabled={i.current_stock <= 0}\r\n                    >\r\n                      {i.current_stock <= 0 ? 'Out of Stock' : 'Add'}\r\n                    </button>\r\n                  </div>\r\n                ))}\r\n                {filtered.length === 0 && <div className=\"text-sm text-gray-500 p-2\">No medicines found.</div>}\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"card p-4\">\r\n              <h3 className=\"font-medium mb-2\">Selected Items</h3>\r\n              <div className=\"space-y-2\">\r\n                {selected.map(s => (\r\n                  <div key={s.item.id} className=\"flex items-center justify-between\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"font-medium\">{s.item.name}</div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        ₹{Number(s.item.sale_price).toFixed(2)} × {s.quantity} = ₹{(Number(s.item.sale_price) * s.quantity).toFixed(2)}\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500\">\r\n                        GST: ₹{((Number(s.item.sale_price) * s.quantity * Number(s.item.gst_rate || 0)) / 100).toFixed(2)}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <input \r\n                        type=\"number\" \r\n                        min={0} \r\n                        max={s.item.current_stock}\r\n                        className=\"w-20 rounded-xl border border-gray-300\" \r\n                        value={s.quantity} \r\n                        onChange={e => updateQty(s.item.id, Number(e.target.value))} \r\n                      />\r\n                      <div className=\"w-24 text-right\">\r\n                        ₹{((Number(s.item.sale_price) * s.quantity) + ((Number(s.item.sale_price) * s.quantity * Number(s.item.gst_rate || 0)) / 100)).toFixed(2)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n                {selected.length === 0 && <div className=\"text-sm text-gray-500\">No items added.</div>}\r\n              </div>\r\n              \r\n              <div className=\"border-t border-gray-100 mt-3 pt-3 text-sm space-y-1\">\r\n                <div className=\"flex justify-between\"><span>Subtotal</span><span>₹{subtotal.toFixed(2)}</span></div>\r\n                <div className=\"flex justify-between\"><span>GST</span><span>₹{gstTotal.toFixed(2)}</span></div>\r\n                <div className=\"flex justify-between font-medium\"><span>Gross Total</span><span>₹{(subtotal + gstTotal).toFixed(2)}</span></div>\r\n                <div className=\"flex justify-between\"><span>Discount</span><span>-₹{Number(discount || 0).toFixed(2)}</span></div>\r\n                <div className=\"flex justify-between text-lg font-semibold\"><span>Net Amount</span><span>₹{net.toFixed(2)}</span></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-3\">\r\n            <button className=\"btn btn-primary\" disabled={submitting}>\r\n              Generate Medicine Bill\r\n            </button>\r\n            <button \r\n              type=\"button\" \r\n              className=\"btn btn-secondary\" \r\n              onClick={() => {\r\n                const id = localStorage.getItem('orthonova_last_bill_id');\r\n                if (!id) { \r\n                  setMessage('No recent bill to reprint'); \r\n                  return; \r\n                }\r\n                const url = `${window.location.origin}/print/bill/${id}`;\r\n                const win = window.open(url, '_blank'); \r\n                if (win) win.focus();\r\n              }}\r\n            >\r\n              Reprint Last\r\n            </button>\r\n          </div>\r\n          \r\n          {message && (\r\n            <p className={`text-sm mt-2 ${message.includes('successfully') ? 'text-green-600' : 'text-red-600'}`}>\r\n              {message}\r\n            </p>\r\n          )}\r\n        </form>\r\n      </div>\r\n\r\n      {/* Patient Selection Modal */}\r\n      <Modal open={patientModalOpen} title=\"Select Patient\" onClose={() => setPatientModalOpen(false)}>\r\n        <div className=\"divide-y divide-gray-100\">\r\n          {patientMatches.map(p => (\r\n            <div key={p.id} className=\"py-2\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <div className=\"font-medium\">\r\n                    {p.name} <span className=\"text-xs text-gray-500\">({p.age} / {p.gender})</span>\r\n                  </div>\r\n                  <div className=\"text-xs text-gray-500\">{p.patient_id} • {p.contact}</div>\r\n                </div>\r\n                <button \r\n                  className=\"btn btn-secondary\" \r\n                  onClick={() => { \r\n                    setPatientId(p.id); \r\n                    setSelectedPatient(p); \r\n                    setPatientModalOpen(false); \r\n                    setPatientMatches([]); \r\n                  }}\r\n                >\r\n                  Select\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n          {patientMatches.length === 0 && <div className=\"py-4 text-sm text-gray-500\">No matches.</div>}\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PharmacyBilling;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}