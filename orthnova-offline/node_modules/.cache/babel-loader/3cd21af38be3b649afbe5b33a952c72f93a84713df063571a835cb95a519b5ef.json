{"ast":null,"code":"import _objectSpread from\"C:/Users/Me/Desktop/orthnova-app/orthnova-offline/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{createPatient}from'../../api';import{calculateAge,generatePatientId}from'../../utils/idGenerators';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PatientRegistration=_ref=>{let{onPatientCreated}=_ref;const[form,setForm]=useState({name:'',dob:'',gender:'Male',contact:'',address:''});const[age,setAge]=useState(0);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[success,setSuccess]=useState(null);const[lastId,setLastId]=useState(null);const onDobChange=dob=>{setForm(f=>_objectSpread(_objectSpread({},f),{},{dob}));if(dob)setAge(calculateAge(dob));else setAge(0);};const onSubmit=async e=>{e.preventDefault();setError(null);setSuccess(null);if(!form.name||!form.dob||!form.contact){setError('Name, DOB and Contact are required');return;}const patient_id=generatePatientId(form.contact,form.name);setLoading(true);try{const createdPatient=await createPatient({id:crypto.randomUUID(),patient_id,name:form.name,dob:form.dob,gender:form.gender,contact:form.contact,address:form.address,age});setSuccess(\"Patient registered with ID \".concat(patient_id));setLastId(patient_id);// Emit the created patient to parent component if callback provided\nif(onPatientCreated){onPatientCreated(createdPatient);}// Reset form\nsetForm({name:'',dob:'',gender:'Male',contact:'',address:''});setAge(0);}catch(e){setError(e.message);}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-4\",children:\"Register Patient\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,className:\"grid grid-cols-1 md:grid-cols-6 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\",value:form.name,onChange:e=>setForm(f=>_objectSpread(_objectSpread({},f),{},{name:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"DOB\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\",value:form.dob,onChange:e=>onDobChange(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Age\"}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-1 w-full rounded-xl border-gray-300\",value:age,readOnly:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Gender\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\",value:form.gender,onChange:e=>setForm(f=>_objectSpread(_objectSpread({},f),{},{gender:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{children:\"Male\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Female\"}),/*#__PURE__*/_jsx(\"option\",{children:\"Other\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Contact\"}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\",value:form.contact,onChange:e=>setForm(f=>_objectSpread(_objectSpread({},f),{},{contact:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Address\"}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\",value:form.address,onChange:e=>setForm(f=>_objectSpread(_objectSpread({},f),{},{address:e.target.value}))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-6 flex items-end justify-end gap-2\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",disabled:loading,children:\"Register\"})})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-2\",children:error}),success&&/*#__PURE__*/_jsx(\"p\",{className:\"text-green-600 text-sm mt-2\",children:success}),lastId&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-700 mt-2\",children:[\"Last registered ID: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-mono\",children:lastId})]})]})});};export default PatientRegistration;","map":{"version":3,"names":["React","useState","createPatient","calculateAge","generatePatientId","jsx","_jsx","jsxs","_jsxs","PatientRegistration","_ref","onPatientCreated","form","setForm","name","dob","gender","contact","address","age","setAge","loading","setLoading","error","setError","success","setSuccess","lastId","setLastId","onDobChange","f","_objectSpread","onSubmit","e","preventDefault","patient_id","createdPatient","id","crypto","randomUUID","concat","message","className","children","value","onChange","target","required","type","readOnly","disabled"],"sources":["C:/Users/Me/Desktop/orthnova-app/orthnova-offline/src/components/patients/PatientRegistration.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { createPatient } from '../../api';\r\nimport { PatientRow } from '../../types';\r\nimport { calculateAge, generatePatientId } from '../../utils/idGenerators';\r\n\r\ninterface PatientRegistrationProps {\r\n  onPatientCreated?: (patient: PatientRow) => void;\r\n}\r\n\r\nconst PatientRegistration: React.FC<PatientRegistrationProps> = ({ onPatientCreated }) => {\r\n  const [form, setForm] = useState<{ name: string; dob: string; gender: 'Male' | 'Female' | 'Other'; contact: string; address: string }>({\r\n    name: '', dob: '', gender: 'Male', contact: '', address: ''\r\n  });\r\n  const [age, setAge] = useState(0);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n  const [lastId, setLastId] = useState<string | null>(null);\r\n\r\n  const onDobChange = (dob: string) => {\r\n    setForm(f => ({...f, dob}));\r\n    if (dob) setAge(calculateAge(dob)); else setAge(0);\r\n  };\r\n\r\n  const onSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setSuccess(null);\r\n    \r\n    if (!form.name || !form.dob || !form.contact) {\r\n      setError('Name, DOB and Contact are required');\r\n      return;\r\n    }\r\n    \r\n    const patient_id = generatePatientId(form.contact, form.name);\r\n    setLoading(true);\r\n    \r\n    try {\r\n      const createdPatient = await createPatient({\r\n        id: crypto.randomUUID(),\r\n        patient_id,\r\n        name: form.name,\r\n        dob: form.dob,\r\n        gender: form.gender,\r\n        contact: form.contact,\r\n        address: form.address,\r\n        age\r\n      });\r\n      \r\n      setSuccess(`Patient registered with ID ${patient_id}`);\r\n      setLastId(patient_id);\r\n      \r\n      // Emit the created patient to parent component if callback provided\r\n      if (onPatientCreated) {\r\n        onPatientCreated(createdPatient);\r\n      }\r\n      \r\n      // Reset form\r\n      setForm({ name: '', dob: '', gender: 'Male', contact: '', address: '' });\r\n      setAge(0);\r\n    } catch (e: any) {\r\n      setError(e.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"card p-6\">\r\n        <h2 className=\"text-xl font-semibold mb-4\">Register Patient</h2>\r\n        <form onSubmit={onSubmit} className=\"grid grid-cols-1 md:grid-cols-6 gap-4\">\r\n          <div className=\"md:col-span-2\">\r\n            <label className=\"block text-sm font-medium\">Name</label>\r\n            <input className=\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\" value={form.name} onChange={e => setForm(f => ({...f, name: e.target.value}))} required />\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">DOB</label>\r\n            <input type=\"date\" className=\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\" value={form.dob} onChange={e => onDobChange(e.target.value)} required />\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">Age</label>\r\n            <input className=\"mt-1 w-full rounded-xl border-gray-300\" value={age} readOnly />\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">Gender</label>\r\n            <select className=\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\" value={form.gender} onChange={e => setForm(f => ({...f, gender: e.target.value as any}))}>\r\n              <option>Male</option>\r\n              <option>Female</option>\r\n              <option>Other</option>\r\n            </select>\r\n          </div>\r\n          <div className=\"md:col-span-2\">\r\n            <label className=\"block text-sm font-medium\">Contact</label>\r\n            <input className=\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\" value={form.contact} onChange={e => setForm(f => ({...f, contact: e.target.value}))} required />\r\n          </div>\r\n          <div className=\"md:col-span-6\">\r\n            <label className=\"block text-sm font-medium\">Address</label>\r\n            <input className=\"mt-1 w-full rounded-xl border-gray-300 focus:ring-brand-500\" value={form.address} onChange={e => setForm(f => ({...f, address: e.target.value}))} />\r\n          </div>\r\n          <div className=\"md:col-span-6 flex items-end justify-end gap-2\">\r\n            <button className=\"btn btn-primary\" disabled={loading}>Register</button>\r\n          </div>\r\n        </form>\r\n        {error && <p className=\"text-red-600 text-sm mt-2\">{error}</p>}\r\n        {success && <p className=\"text-green-600 text-sm mt-2\">{success}</p>}\r\n        {lastId && <p className=\"text-sm text-gray-700 mt-2\">Last registered ID: <span className=\"font-mono\">{lastId}</span></p>}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PatientRegistration;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}